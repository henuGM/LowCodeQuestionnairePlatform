"use strict";(self.webpackChunkwenjuan=self.webpackChunkwenjuan||[]).push([[166],{49917:(e,n,s)=>{s.r(n),s.d(n,{default:()=>Ge});var i=s(65043),t=s(39926);const c="Edit_container__G3Rbz",l="Edit_content-wrapper__UrZLV",r="Edit_content__+CP05",d="Edit_left__GfCmr",o="Edit_main__ol4VE",a="Edit_canvas-wrapper__cVXTX",x="Edit_right__Ujxri",j="EditCanvas_canvas__X1YZ-",u="EditCanvas_component-wrapper__T91W6",p="EditCanvas_selected__S041I",A="EditCanvas_locked__3BAzF",h="EditCanvas_component__ygwF-";var m=s(42919),_=s(31579),f=s(3263),v=s(82925),y=s(83003),C=s(98139),g=s.n(C),E=s(23585),k=s(1648),w=s(70579);const b=e=>{const{children:n,items:s,onDragEnd:i}=e,t=(0,E.FR)((0,E.MS)(E.cA,{activationConstraint:{distance:8}}));return(0,w.jsx)(E.Mp,{sensors:t,collisionDetection:E.fp,onDragEnd:function(e){const{active:n,over:t}=e;if(null!=t&&n.id!==t.id){const e=s.findIndex((e=>e.fe_id===n.id)),c=s.findIndex((e=>e.fe_id===t.id));i(e,c)}},children:(0,w.jsx)(k.gB,{items:s,strategy:k._G,children:n})})};var N=s(41024);const I=e=>{let{id:n,children:s}=e;const{attributes:i,listeners:t,setNodeRef:c,transform:l,transition:r}=(0,k.gl)({id:n}),d={transform:N.Ks.Transform.toString(l),transition:r};return(0,w.jsx)("div",{ref:c,style:d,...i,...t,children:s})};function L(e){const{type:n,props:s}=e,i=(0,v.T)(n);if(null==i)return null;const{Component:t}=i;return(0,w.jsx)(t,{...s})}const T=e=>{let{loading:n}=e;const{componentList:s,selectedId:i=""}=(0,_.A)(),t=(0,y.wA)();if(n)return(0,w.jsx)("div",{style:{textAlign:"center",marginTop:"24px"},children:(0,w.jsx)(m.A,{})});const c=s.map((e=>({...e,id:e.fe_id})));return(0,w.jsx)(b,{items:c,onDragEnd:function(e,n){t((0,f.pp)({oldIndex:e,newIndex:n}))},children:(0,w.jsx)("div",{className:j,children:s.filter((e=>!e.isHidden)).map((e=>{const{fe_id:n,isLocked:s}=e,c=u,l=p,r=A,d=g()({[c]:!0,[l]:n===i,[r]:s});return(0,w.jsx)(I,{id:n,children:(0,w.jsx)("div",{className:d,onClick:e=>{return s=n,e.stopPropagation(),void t((0,f.RC)(s));var s},children:(0,w.jsx)("div",{className:h,children:L(e)})})},n)}))})})};var P=s(74563),S=s(37644),K=s(6051),H=s(29437),R=s(29752);const z="ComponentLib_wrapper__vGUal",Y="ComponentLib_component__+Oxbn";var F=s(19452);const{Title:V}=R.A;const D=()=>(0,w.jsx)(w.Fragment,{children:v.j.map(((e,n)=>{const{groupId:s,groupName:i,components:t}=e;return(0,w.jsxs)("div",{children:[(0,w.jsx)(V,{level:3,style:{fontSize:"16px",marginTop:n>0?"6px":"0px"},children:i}),t.map((e=>function(e){const{title:n,type:s,Component:i,defaultProps:t}=e,c=(0,y.wA)();return(0,w.jsx)("div",{className:z,onClick:function(){c((0,f.X8)({fe_id:(0,F.Ak)(),title:n,type:s,props:t}))},children:(0,w.jsx)("div",{className:Y,children:(0,w.jsx)(i,{})})},s)}(e)))]},s)}))});var G=s(51118),O=s(25389),M=s(87021);const X="Layers_wrapper__0Vo73",q="Layers_title__2DX0i",B="Layers_selected__mwsYP",Z="Layers_handler__M0z2K",U="Layers_btn__lwLs0";var W=s(82692),J=s(98617);const Q=()=>{const{componentList:e,selectedId:n}=(0,_.A)(),s=(0,y.wA)(),[t,c]=(0,i.useState)("");function l(e){const i=e.target.value.trim();i&&n&&s((0,f.oA)({fe_id:n,title:i}))}const r=e.map((e=>({...e,id:e.fe_id})));return(0,w.jsx)(b,{items:r,onDragEnd:function(e,n){s((0,f.pp)({oldIndex:e,newIndex:n}))},children:e.map((i=>{const{fe_id:r,title:d,isHidden:o,isLocked:a}=i,x=q,j=B,u=g()({[x]:!0,[j]:r===n});return(0,w.jsx)(I,{id:r,children:(0,w.jsxs)("div",{className:X,children:[(0,w.jsxs)("div",{className:u,onClick:()=>function(i){const t=e.find((e=>e.fe_id===i));if(!t||!t.isHidden)return i!==n?(s((0,f.RC)(i)),void c("")):void c(i);G.Ay.info("\u4e0d\u80fd\u9009\u4e2d\u9690\u85cf\u7684\u7ec4\u4ef6")}(r),children:[r===t&&(0,w.jsx)(O.A,{value:d,onChange:l,onPressEnter:()=>c(""),onBlur:()=>c("")}),r!==t&&d]}),(0,w.jsx)("div",{className:Z,children:(0,w.jsxs)(K.A,{children:[(0,w.jsx)(M.Ay,{size:"small",shape:"circle",className:o?"":U,icon:(0,w.jsx)(W.A,{}),type:o?"primary":"text",onClick:()=>function(e,n){s((0,f.CK)({fe_id:e,isHidden:n}))}(r,!o)}),(0,w.jsx)(M.Ay,{size:"small",shape:"circle",className:a?"":U,icon:(0,w.jsx)(J.A,{}),type:a?"primary":"text",onClick:()=>function(e){s((0,f.ON)({fe_id:e}))}(r)})]})})]})},r)}))})},$=()=>{const e=[{key:"componentLib",label:(0,w.jsxs)(K.A,{children:[(0,w.jsx)(P.A,{}),"\u7ec4\u4ef6\u5e93"]}),children:(0,w.jsx)(D,{})},{key:"layers",label:(0,w.jsxs)(K.A,{children:[(0,w.jsx)(S.A,{}),"\u56fe\u5c42"]}),children:(0,w.jsx)(Q,{})}];return(0,w.jsx)(H.A,{defaultActiveKey:"componentLib",items:e})};var ee=s(36091),ne=s(14524);const se=()=>(0,w.jsx)("div",{style:{textAlign:"center"},children:"\u672a\u9009\u4e2d\u7ec4\u4ef6"}),ie=()=>{const e=(0,y.wA)(),{selectedComponent:n}=(0,_.A)();if(null==n)return(0,w.jsx)(se,{});const{type:s,props:i,isLocked:t,isHidden:c}=n,l=(0,v.T)(s);if(null==l)return(0,w.jsx)(se,{});const{PropComponent:r}=l;return(0,w.jsx)(r,{...i,onChange:function(s){if(null==n)return;const{fe_id:i}=n;e((0,f.Kb)({fe_id:i,newProps:s}))},disabled:t||c})};var te=s(7717),ce=s(6561),le=s(41361);const{TextArea:re}=O.A,de=()=>{const e=(0,ce.A)(),[n]=te.A.useForm(),s=(0,y.wA)();return(0,i.useEffect)((()=>{n.setFieldsValue(e)}),[e]),(0,w.jsxs)(te.A,{layout:"vertical",initialValues:e,onValuesChange:function(){s((0,le.nq)(n.getFieldsValue()))},form:n,children:[(0,w.jsx)(te.A.Item,{label:"\u95ee\u5377\u6807\u9898",name:"title",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6807\u9898"}],children:(0,w.jsx)(O.A,{placeholder:"\u8bf7\u8f93\u5165\u6807\u9898"})}),(0,w.jsx)(te.A.Item,{label:"\u95ee\u5377\u63cf\u8ff0",name:"desc",children:(0,w.jsx)(re,{placeholder:"\u95ee\u5377\u63cf\u8ff0..."})}),(0,w.jsx)(te.A.Item,{label:"\u6837\u5f0f\u4ee3\u7801",name:"css",children:(0,w.jsx)(re,{placeholder:"\u8f93\u5165 CSS \u6837\u5f0f\u4ee3\u7801..."})}),(0,w.jsx)(te.A.Item,{label:"\u811a\u672c\u4ee3\u7801",name:"js",children:(0,w.jsx)(re,{placeholder:"\u8f93\u5165 JS \u811a\u672c\u4ee3\u7801..."})})]})};var oe=function(e){return e.PROP_KEY="prop",e.SETTING_KEY="setting",e}(oe||{});const ae=()=>{const[e,n]=(0,i.useState)(oe.PROP_KEY),{selectedId:s}=(0,_.A)();(0,i.useEffect)((()=>{n(s?oe.PROP_KEY:oe.SETTING_KEY)}),[s]);const t=[{key:oe.PROP_KEY,label:(0,w.jsxs)(K.A,{children:[(0,w.jsx)(ee.A,{}),"\u5c5e\u6027"]}),children:(0,w.jsx)(ie,{})},{key:oe.SETTING_KEY,label:(0,w.jsxs)(K.A,{children:[(0,w.jsx)(ne.A,{}),"\u9875\u9762\u8bbe\u7f6e"]}),children:(0,w.jsx)(de,{})}];return(0,w.jsx)(H.A,{activeKey:e,items:t})};var xe=s(73216);const je="EditHeader_header-wrapper__oM6Ym",ue="EditHeader_header__jKH4q",pe="EditHeader_h1__Re68a",Ae="EditHeader_left__63WhQ",he="EditHeader_main__Mmg6p",me="EditHeader_right__WL0se";var _e=s(67407),fe=s(40164),ve=s(682),ye=s(96651),Ce=s(61966),ge=s(9025),Ee=s(7047),ke=s(45591),we=s(28369),be=s(55574),Ne=s(42144),Ie=s(28419);const Le=()=>{const e=(0,y.wA)(),{selectedId:n,selectedComponent:s,copiedComponent:i,componentList:t}=(0,_.A)(),{isLocked:c}=s||{},l=t.length,r=t.findIndex((e=>e.fe_id===n)),d=r<=0,o=r+1>=l;return(0,w.jsxs)(K.A,{children:[(0,w.jsx)(ye.A,{title:"\u5220\u9664",children:(0,w.jsx)(M.Ay,{shape:"circle",icon:(0,w.jsx)(Ce.A,{}),onClick:function(){e((0,f.Tg)())}})}),(0,w.jsx)(ye.A,{title:"\u9690\u85cf",children:(0,w.jsx)(M.Ay,{shape:"circle",icon:(0,w.jsx)(W.A,{}),onClick:function(){e((0,f.CK)({fe_id:n,isHidden:!0}))}})}),(0,w.jsx)(ye.A,{title:"\u9501\u5b9a",children:(0,w.jsx)(M.Ay,{shape:"circle",icon:(0,w.jsx)(J.A,{}),onClick:function(){e((0,f.ON)({fe_id:n}))},type:c?"primary":"default"})}),(0,w.jsx)(ye.A,{title:"\u590d\u5236",children:(0,w.jsx)(M.Ay,{shape:"circle",icon:(0,w.jsx)(ge.A,{}),onClick:function(){e((0,f.Sk)())}})}),(0,w.jsx)(ye.A,{title:"\u7c98\u8d34",children:(0,w.jsx)(M.Ay,{shape:"circle",icon:(0,w.jsx)(Ee.A,{}),onClick:function(){e((0,f.F7)())},disabled:null==i})}),(0,w.jsx)(ye.A,{title:"\u4e0a\u79fb",children:(0,w.jsx)(M.Ay,{shape:"circle",icon:(0,w.jsx)(ke.A,{}),onClick:function(){d||e((0,f.pp)({oldIndex:r,newIndex:r-1}))},disabled:d})}),(0,w.jsx)(ye.A,{title:"\u4e0b\u79fb",children:(0,w.jsx)(M.Ay,{shape:"circle",icon:(0,w.jsx)(we.A,{}),onClick:function(){o||e((0,f.pp)({oldIndex:r,newIndex:r+1}))},disabled:o})}),(0,w.jsx)(ye.A,{title:"\u64a4\u9500",children:(0,w.jsx)(M.Ay,{shape:"circle",icon:(0,w.jsx)(be.A,{}),onClick:function(){e(Ie.IE.undo())}})}),(0,w.jsx)(ye.A,{title:"\u91cd\u505a",children:(0,w.jsx)(M.Ay,{shape:"circle",icon:(0,w.jsx)(Ne.A,{}),onClick:function(){e(Ie.IE.redo())}})})]})};var Te=s(36823),Pe=s(26998),Se=s(76094),Ke=s(58796);const{Title:He}=R.A,Re=()=>{const{title:e}=(0,ce.A)(),n=(0,i.useRef)(null),s=(0,y.wA)(),[t,c]=(0,i.useState)(!1);return t?(0,w.jsx)(O.A,{ref:n,value:e,onChange:function(e){const n=e.target.value.trim();n&&s((0,le.I5)(n))},onPressEnter:()=>c(!1),onBlur:()=>c(!1)}):(0,w.jsxs)(K.A,{style:{margin:"-10px 0"},children:[(0,w.jsx)(He,{className:pe,children:e}),(0,w.jsx)(M.Ay,{icon:(0,w.jsx)(_e.A,{}),type:"text",onClick:()=>{c(!0),setTimeout((()=>{n.current.focus({cursor:"end"})}),300)}})]})},ze=()=>{const{id:e}=(0,xe.g)(),{componentList:n=[]}=(0,_.A)(),s=(0,ce.A)(),{loading:i,run:t}=(0,Pe.A)((async()=>{e&&await(0,Te.Tg)(e,{...s,componentList:n})}),{manual:!0});return(0,Se.A)(["ctrl.s","meta.s"],(e=>{e.preventDefault(),i||t()})),(0,Ke.A)((()=>{t()}),[n,s],{wait:1e3}),(0,w.jsx)(M.Ay,{onClick:t,disabled:i,icon:i?(0,w.jsx)(fe.A,{}):null,children:"\u4fdd\u5b58"})},Ye=()=>{const e=(0,xe.Zp)(),{id:n}=(0,xe.g)(),{componentList:s=[]}=(0,_.A)(),i=(0,ce.A)(),{loading:t,run:c}=(0,Pe.A)((async()=>{n&&await(0,Te.Tg)(n,{...i,componentList:s,isPublished:!0})}),{manual:!0,onSuccess(){G.Ay.success("\u53d1\u5e03\u6210\u529f"),e("/question/stat/"+n)}});return(0,w.jsx)(M.Ay,{type:"primary",onClick:c,disabled:t,children:"\u53d1\u5e03"})},Fe=()=>{const e=(0,xe.Zp)();return(0,w.jsx)("div",{className:je,children:(0,w.jsxs)("div",{className:ue,children:[(0,w.jsx)("div",{className:Ae,children:(0,w.jsxs)(K.A,{children:[(0,w.jsx)(M.Ay,{type:"link",icon:(0,w.jsx)(ve.A,{}),onClick:()=>e(-1),children:"\u8fd4\u56de"}),(0,w.jsx)(Re,{})]})}),(0,w.jsx)("div",{className:he,children:(0,w.jsx)(Le,{})}),(0,w.jsx)("div",{className:me,children:(0,w.jsxs)(K.A,{children:[(0,w.jsx)(ze,{}),(0,w.jsx)(Ye,{})]})})]})})};function Ve(){const e=document.activeElement;return e==document.body||!(null===e||void 0===e||!e.matches('div[role="button"]'))}const De=function(){const e=(0,y.wA)();(0,Se.A)(["backspace","delete"],(()=>{Ve()&&e((0,f.Tg)())})),(0,Se.A)(["ctrl.c","meta.c"],(()=>{Ve()&&e((0,f.Sk)())})),(0,Se.A)(["ctrl.v","meta.v"],(()=>{Ve()&&e((0,f.F7)())})),(0,Se.A)("upArrow",(()=>{Ve()&&e((0,f.p5)())})),(0,Se.A)("downArrow",(()=>{Ve()&&e((0,f.t$)())})),(0,Se.A)(["ctrl.z","meta.z"],(()=>{Ve()&&e(Ie.IE.undo())}),{exactMatch:!0}),(0,Se.A)(["ctrl.shift.z","meta.shift.z"],(()=>{Ve()&&e(Ie.IE.redo())}))},Ge=()=>{const{loading:e,data:n}=(0,t.A)(),s=(0,y.wA)();return De(),(0,w.jsxs)("div",{className:c,children:[(0,w.jsx)("div",{style:{backgroundColor:"#fff"},children:(0,w.jsx)(Fe,{})}),(0,w.jsx)("div",{className:l,children:(0,w.jsxs)("div",{className:r,children:[(0,w.jsx)("div",{className:d,children:(0,w.jsx)($,{})}),(0,w.jsx)("div",{className:o,onClick:function(){s((0,f.RC)(""))},children:(0,w.jsx)("div",{className:a,children:(0,w.jsx)(T,{loading:e})})}),(0,w.jsx)("div",{className:x,children:(0,w.jsx)(ae,{})})]})})]})}}}]);
//# sourceMappingURL=editPage.3e43e398.chunk.js.map